# 对象

Riddle Language 的对象管理系统借鉴了 Rust 的所有权模型，实现了安全、高效的内存管理。 它允许开发者通过所有权和借用机制明确控制对象的生命周期，避免常见的内存泄漏和悬空指针问题， 同时不需要手动内存管理或垃圾回收。

## 所有权 (Ownership)

在 Riddle 中，每个对象都遵循一个简单的所有权规则：每个对象在任何时刻只能有一个所有者。当所有权转移时， 旧的所有者将失去对对象的访问权限。这种机制确保了内存安全，并防止对象被多次释放。

### 示例：所有权转移

```java
var a = new MyObject() // a 拥有这个对象的所有权
var b = a              // 所有权转移到 b, a 变为 null

var c = a              // 此时 c 获取 a 将会报错
```

## 引用 (References)

与所有权不同，Riddle 支持通过引用使得让多个变量可以获取到同一对象的属性。**注意，引用是对变量而言而不是对对象而言的**， 如果需要对某个对象进行追踪，请使用[绑定](#bind)

### 示例：引用

```java
var a = new MyObject() 
var b = &a              // b 获取了对 a 的引用
var c = a               // 仍然可以正常访问 a          

var d = a               // a 的所有权被转移
var e = b               // 此时将会报错，因为 a 中没有任何对象
```

需要注意的是，引用的所有权将不会被转移，也就是说你将一个引用赋值给一个变量， 实际上是将该引用拷贝给了该变量

### 示例：引用传递

```java
var a = new MyObject()
var b = &a
var c = b   // 此时 c 中保存的是对 a 的引用
```

## 绑定 (Bind)

Riddle 提供了 绑定 的概念，用来在多个地方追踪同一个对象。与引用不同，绑定确保**即使对象所有权发生变化， 其他绑定的变量仍然可以访问这个对象**。 绑定通过引用计数 ( 类似于 C++ 中的 [std:shared_ptr](https://zh.cppreference.com/w/cpp/memory/shared_ptr) )

### 示例：绑定

```java
var a = new MyObject()
var b = @a              // b 获取了对 a 中所存的对象的绑定
var c = a

// 此时 b 中存的是 c 中的对象
```

需要注意的是，绑定的所有权不会被转移，也就是说你将一个绑定赋值给一个变量， 实际上是将该绑定拷贝给了该变量

### 示例：绑定传递

```java
var a = new MyObject()
var b = @a           
var c = b

// 此时 c 中存的是对 a 中对象的绑定
```

**注：此处为实验性，后续可能会改变**